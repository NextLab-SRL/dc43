{% extends "base.html" %}
{% block content %}
<h1 class="mb-3">Data products</h1>
<p class="text-muted">Browse Open Data Product Standard definitions discovered in the workspace. Each entry links contract bindings to upstream inputs and downstream outputs so you can trace how datasets flow between teams.</p>
{% if data_products %}
<div class="table-responsive">
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th scope="col">Data product</th>
        <th scope="col">Latest release</th>
        <th scope="col">Ports</th>
        <th scope="col">Version history</th>
      </tr>
    </thead>
    <tbody>
    {% for product in data_products %}
      <tr>
        <th scope="row">
          <div class="fw-semibold">{{ product.name }}</div>
          <div class="small text-muted">{{ product.id }}</div>
          {% if product.description %}
            <div class="small mt-1">{{ product.description }}</div>
          {% endif %}
        </th>
        <td>
          <div>{{ product.latest_version }}</div>
          <span class="badge {{ 'bg-success' if product.latest_status == 'active' else 'bg-secondary' }}">{{ product.latest_status_label }}</span>
        </td>
        <td>
          {% if product.input_ports %}
            <div class="small text-muted">Inputs</div>
            <ul class="list-unstyled small mb-2">
              {% for port in product.input_ports %}
                <li>{{ port.name }} → <code>{{ port.contract_id }}</code> {{ port.version }}</li>
              {% endfor %}
            </ul>
          {% endif %}
          {% if product.output_ports %}
            <div class="small text-muted">Outputs</div>
            <ul class="list-unstyled small mb-0">
              {% for port in product.output_ports %}
                <li>{{ port.name }} → <code>{{ port.contract_id }}</code> {{ port.version }}</li>
              {% endfor %}
            </ul>
          {% endif %}
          {% if not product.input_ports and not product.output_ports %}
            <span class="text-muted">—</span>
          {% endif %}
        </td>
        <td>
          {% if product.other_versions %}
            <ul class="list-unstyled small mb-0">
              {% for version in product.other_versions|reverse %}
                <li>{{ version.version }} · {{ version.status_label }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <span class="text-muted">—</span>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<p class="text-muted">No data products registered yet.</p>
{% endif %}
{% endblock %}
